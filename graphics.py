# -*- coding: utf-8 -*-
"""Graphics

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1dgzT9HBk3F4Gg1Hzze7mNaomRAK-2VpH
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Загрузите ваш датасет
data = pd.read_csv('/content/sample_data/test.csv')

data['datetime'] = pd.to_datetime(data['tpep_pickup_datetime'])

# Добавьте столбцы с днем, часом и названием дня недели
data['day'] = data['datetime'].dt.date
data['hour'] = data['datetime'].dt.hour
data['weekday'] = data['datetime'].dt.day_name()

weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']

# Рассчитаем среднюю стоимость, заполнив пропущенные дни нулями
weekday_costs = data.groupby('weekday')['tip_amount'].mean()
weekday_costs = weekday_costs.reindex(weekday_order, fill_value=0)

# Построение графика
plt.figure(figsize=(12, 6))
sns.barplot(x=weekday_costs.index, y=weekday_costs.values, palette='coolwarm')
plt.title('Средняя стоимость поездки по дням недели')
plt.xlabel('День недели')
plt.ylabel('Средняя стоимость')
plt.xticks(rotation=45)
plt.grid(axis='y')
plt.show()


# 2. График зависимости стоимости от часа дня
plt.figure(figsize=(12, 6))
hourly_costs = data.groupby('hour')['tip_amount'].mean()
sns.barplot(x=hourly_costs.index, y=hourly_costs.values, palette='viridis')
plt.title('Средняя стоимость поездки по часам дня')
plt.xlabel('Час дня')
plt.ylabel('Средняя стоимость')
plt.grid(axis='y')
plt.show()





